project_name: my-nebari-aws
provider: aws
domain: nebari.example.com

# TLS certificate configuration
certificate:
  type: selfsigned # Options: "selfsigned" or "letsencrypt"
  # For Let's Encrypt (production), use:
  # type: letsencrypt
  # acme:
  #   email: admin@example.com

# GitOps repository configuration (required for foundational services)
# ArgoCD uses this repository to deploy Envoy Gateway, cert-manager, Keycloak, etc.
git_repository:
  url: "git@github.com:my-org/my-gitops-repo.git"
  branch: main
  path: "clusters/my-nebari-aws"  # Optional subdirectory within the repo
  auth:
    ssh_key_env: GIT_SSH_PRIVATE_KEY  # Environment variable containing SSH private key
    # OR use token for HTTPS:
    # token_env: GIT_TOKEN
  # Optional: separate read-only credentials for ArgoCD (falls back to auth if not set)
  # argocd_auth:
  #   ssh_key_env: ARGOCD_SSH_KEY

amazon_web_services:
  region: us-west-2
  kubernetes_version: "1.34"
  availability_zones:
    - us-west-2a
    - us-west-2b
  vpc_cidr_block: "10.10.0.0/16"
  endpoint_private_access: true
  endpoint_public_access: true

  node_groups:
    # general:
    #   instance: m7i.2xlarge
    #   min_nodes: 1
    #   max_nodes: 1
    #   # AL2023 is now the default AMI type (AL2023_x86_64_STANDARD)

    user:
      instance: m7i.xlarge
      min_nodes: 1 # minimum of 1 node required
      max_nodes: 5

    # worker:
    #   instance: m7i.xlarge
    #   min_nodes: 0
    #   max_nodes: 5
    #
    # # Example: GPU node group with AL2023 NVIDIA AMI
    # gpu:
    #   instance: g5.xlarge
    #   min_nodes: 0
    #   max_nodes: 3
    #   gpu: true # Uses AL2023_x86_64_NVIDIA AMI
    #
    # # Example: ARM64 Graviton node group
    # graviton:
    #   instance: m7g.xlarge
    #   min_nodes: 0
    #   max_nodes: 5
    #   ami_type: AL2023_ARM_64_STANDARD
    #
    # # Example: AWS Neuron (Inferentia/Trainium) node group
    # neuron:
    #   instance: inf2.xlarge
    #   min_nodes: 0
    #   max_nodes: 2
    #   ami_type: AL2023_x86_64_NEURON

  # EFS configuration for shared storage (optional)
  # Creates an EFS file system with mount targets in each private subnet
  efs:
    enabled: true
    performance_mode: generalPurpose # generalPurpose or maxIO
    throughput_mode: bursting # bursting, provisioned, or elastic
    encrypted: true
    # storage_class_name: efs-sc      # Name for the K8s StorageClass (default: efs-sc)
    # kms_key_id: ""                  # Optional: KMS key ARN for encryption
    # provisioned_mbps: 100           # Required if throughput_mode is provisioned

  tags:
    Environment: development
    Project: nebari
